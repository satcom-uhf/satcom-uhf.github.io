{"id":347,"date":"2018-03-20T18:38:49","date_gmt":"2018-03-20T15:38:49","guid":{"rendered":"http:\/\/olegkutkov.me\/?p=347"},"modified":"2021-02-04T22:48:28","modified_gmt":"2021-02-04T20:48:28","slug":"autonomous-allsky-camera-with-raspberry-pi-part-1-overview","status":"publish","type":"post","link":"https:\/\/olegkutkov.me\/2018\/03\/20\/autonomous-allsky-camera-with-raspberry-pi-part-1-overview\/","title":{"rendered":"Autonomous Allsky camera with Raspberry PI. Part 1: overview."},"content":{"rendered":"<p><img loading=\"lazy\" decoding=\"async\" class=\"alignleft wp-image-348\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/02\/allsky_overview_alpha_8-300x245.png\" alt=\"\" width=\"250\" height=\"204\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/02\/allsky_overview_alpha_8-300x245.png 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/02\/allsky_overview_alpha_8-768x626.png 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/02\/allsky_overview_alpha_8.png 850w\" sizes=\"(max-width: 250px) 100vw, 250px\" \/>Allsky (or weather) camera is one of the most important parts of the modern observatory.<br \/>\nIt&#8217;s important to monitor sky conditions during night observations, especially when the observatory is remote controlled or fully automatic. Different vendors provide different solutions. But all they are share the same problems: very high prices, lack of autonomy (PC is required), and lack of useful sensors like temperature, sky temperature, and so on. To build a complete system, you need the camera itself, PC, weather station, and cloud sensor. The full price and complexity of this system are very high.<br \/>\nBut this, not a Jedi path, right?<br \/>\nWith this article, I&#8217;m starting the cycle of the materials dedicated to fully autonomous devices based on Raspberry Pi. This device contains two cameras and a lot of sensors.<\/p>\n<p><!--more--><\/p>\n<p>To build this device, I used a small ABS electricity case from the hardware store. I&#8217;ve made a hole and glued a 120mm dome from the CCTV camera on the top cap. Also, the IR cloud sensor can be found here. Please read <a href=\"http:\/\/olegkutkov.me\/2017\/08\/10\/mlx90614-raspberry\/\">my article<\/a> about this sensor.<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_overview_with_labels.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-385\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_overview_with_labels-300x216.jpg\" alt=\"\" width=\"546\" height=\"393\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_overview_with_labels-300x216.jpg 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_overview_with_labels-768x553.jpg 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_overview_with_labels-1024x738.jpg 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_overview_with_labels.jpg 1080w\" sizes=\"(max-width: 546px) 100vw, 546px\" \/><\/a>On the north side of the camera box, you can see an external temperature\/humidity sensor in a separate aluminum &#8220;cup&#8221;.<\/p>\n<p>Originally used popular DHT22 sensor, but this sensor appeared to be very unstable and not reliable.\u00a0 After one month, this sensor was replaced with HTU21D. You can <a href=\"http:\/\/olegkutkov.me\/2018\/02\/21\/htu21d-raspberry-pi\/\">read here<\/a> about this replacement.<\/p>\n<p>Later I will show you what&#8217;s inside this cup and how the sensor is arranged.<\/p>\n<h3>Cameras module<\/h3>\n<p>Two cameras are placed under the dome.<br \/>\nYou can see mechanical construction in the photo below.<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_modules.png\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-410\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_modules-300x160.png\" alt=\"\" width=\"576\" height=\"307\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_modules-300x160.png 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_modules-768x409.png 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_modules.png 1016w\" sizes=\"(max-width: 576px) 100vw, 576px\" \/><\/a>The vertical camera is allsky. This is a popular and cheap QHY5-IIM astrocam. The lens is also CCTV, \u0421omputar 1.8-3.6mm 1.6<br \/>\nThis lens contains an IRIS motor used to close the camera in a day time to prevent damage to the image sensor.<\/p>\n<p>The second horizontal camera is a Raspberry camera module, the first version. This module is also equipped with a CCTV lens using a handmade adapter.<\/p>\n<p>Everything you need to build such camera module is a few PCB stands, an aluminum ring, a stripe, and a small plate.<br \/>\nIn the next articles, I will describe how to modify the CCTV iris motor and construct such a module.<\/p>\n<h3>Box internals overview<\/h3>\n<p>Inside the box, you can find a few modules: power supply, Raspberry PI 2 computer, protection circuit, and cooling fans.<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_internals_with_labels.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-413\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_internals_with_labels-300x218.jpg\" alt=\"\" width=\"560\" height=\"407\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_internals_with_labels-300x218.jpg 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_internals_with_labels-768x558.jpg 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_internals_with_labels-1024x743.jpg 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam_internals_with_labels-1200x871.jpg 1200w\" sizes=\"(max-width: 560px) 100vw, 560px\" \/><\/a><\/p>\n<p>Since this box is power via Ethernet cable using wide voltage values, I&#8217;ve made this special power supply that can produce three voltages:<\/p>\n<ul>\n<li>12v using linear regulator for the FANs and Iris motor<\/li>\n<li>5v using impulse regulator for the QHY5 USB camera<\/li>\n<li>3.3v using impulse regulator for the Raspberry coreAlso on this board placed MOSFET driver for the FANs control. Please read <a href=\"http:\/\/olegkutkov.me\/2018\/03\/22\/autonomous-allsky-camera-with-raspberry-pi-part-2-powering-and-lightning-protection\/\">part 2<\/a> for details and schematics.<\/li>\n<\/ul>\n<h3>Cooling system<\/h3>\n<p>Two FANs are used to pump warm air through the box via an internal heat exchanger.<br \/>\nThis exchanger is connected to an external, bigger one, which emits heat to space and ambient air.<\/p>\n<p>This combined heat exchanger was made from the two aluminum radiators.<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/heat_exchangers.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-415\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/heat_exchangers-300x165.jpg\" alt=\"\" width=\"560\" height=\"308\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/heat_exchangers-300x165.jpg 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/heat_exchangers-768x422.jpg 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/heat_exchangers-1024x563.jpg 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/heat_exchangers.jpg 1200w\" sizes=\"(max-width: 560px) 100vw, 560px\" \/><\/a>This construction is tested at the hot Crimean summer and works well&#8230;<\/p>\n<h3>EMI and thermal shielding<\/h3>\n<p>The bottom of the box is covered with foil thermal insulation, which supports internal temperature in any weather conditions.<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_9481.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-404 size-large\" src=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_9481-e1592561729588-1024x683.jpg\" alt=\"\" width=\"708\" height=\"472\" \/><\/a><\/p>\n<p>Thermal insulation is also covered with copper foil, which acts as an EMI shield for the whole device.<\/p>\n<p>The top cap is also covered with that foil. Both parts are interconnected at multiple points.<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0647.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-395\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0647-300x225.jpg\" alt=\"\" width=\"560\" height=\"420\" \/><\/a><\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0659.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-401\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0659-300x225.jpg\" alt=\"\" width=\"560\" height=\"420\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0659-300x225.jpg 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0659-768x576.jpg 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0659-1024x768.jpg 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/IMG_0659-1200x900.jpg 1200w\" sizes=\"(max-width: 560px) 100vw, 560px\" \/><\/a> This shield should be properly grounded.<\/p>\n<h3>Electrical connections<\/h3>\n<p>In the picture below, you can see the schematic of all connections inside the box.<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/internal_schematic.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-416\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/internal_schematic-300x212.jpg\" alt=\"\" width=\"570\" height=\"403\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/internal_schematic-300x212.jpg 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/internal_schematic-768x543.jpg 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/internal_schematic-1024x724.jpg 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/internal_schematic.jpg 1029w\" sizes=\"(max-width: 570px) 100vw, 570px\" \/><\/a>Most of the devices are using the I2C bus, which is very convenient.<\/p>\n<p>External RTC is used to restore system time after power or internet failure.<br \/>\nThis is very important for database consistent.<\/p>\n<p>The internal temperature\/humidity sensor is still DHT22 due to the impossibility of using the two HTU21 sensors on the same I2C bus. Second (i2c-0) is unusable due to the Raspberry camera module, which uses this bus somehow.<\/p>\n<h3>Camera sample images and data<\/h3>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam1_n.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-798\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam1_n-300x225.jpg\" alt=\"\" width=\"609\" height=\"457\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam1_n-300x225.jpg 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam1_n-768x576.jpg 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam1_n-1024x768.jpg 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam1_n-1200x900.jpg 1200w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam1_n.jpg 1280w\" sizes=\"(max-width: 609px) 100vw, 609px\" \/><\/a><\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam2_n.jpg\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-large wp-image-490\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam2_n-1024x768.jpg\" alt=\"\" width=\"840\" height=\"630\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam2_n.jpg 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam2_n-300x225.jpg 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/cam2_n-768x576.jpg 768w\" sizes=\"(max-width: 840px) 100vw, 840px\" \/><\/a><\/p>\n<p>As you can see, there is a lot of additional information on the pictures.<br \/>\nThis is actual data about camera ambient conditions.<\/p>\n<p>Images from both cameras are used to generate time-lapse videos.<br \/>\nAfter generation, all videos are uploading to the Camera Youtube channel. <a href=\"https:\/\/www.youtube.com\/channel\/UC9mot5kKa6-PNMAXGx5_Sig\">Check it out<\/a>.<\/p>\n<p>A separate script makes generation and uploading on a separate machine, and it&#8217;s not an actual part of the camera.<\/p>\n<p>The Raspberry runs the Nginx web server to support the web interface of the camera.<br \/>\nThis interface is pretty simple and convenient.<br \/>\nThe whole web page looks like that in the day time:<a href=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_main_page.png\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-1293 size-large\" src=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_main_page-1024x775.png\" alt=\"\" width=\"708\" height=\"536\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_main_page-1024x775.png 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_main_page-300x227.png 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_main_page-768x582.png 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_main_page-1536x1163.png 1536w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/allsky_main_page.png 1776w\" sizes=\"(max-width: 708px) 100vw, 708px\" \/><\/a><br \/>\nAnd in the night time:<\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/FireShot-Capture-005-AllSky-camera-web-interface-http___azt8.craocrimea.ru_9180_index.html.png\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-386\" src=\"http:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/FireShot-Capture-005-AllSky-camera-web-interface-http___azt8.craocrimea.ru_9180_index.html-300x239.png\" alt=\"\" width=\"580\" height=\"461\" srcset=\"https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/FireShot-Capture-005-AllSky-camera-web-interface-http___azt8.craocrimea.ru_9180_index.html-300x239.png 300w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/FireShot-Capture-005-AllSky-camera-web-interface-http___azt8.craocrimea.ru_9180_index.html-768x611.png 768w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/FireShot-Capture-005-AllSky-camera-web-interface-http___azt8.craocrimea.ru_9180_index.html-1024x815.png 1024w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/FireShot-Capture-005-AllSky-camera-web-interface-http___azt8.craocrimea.ru_9180_index.html-1200x955.png 1200w, https:\/\/olegkutkov.me\/wp-content\/uploads\/2018\/03\/FireShot-Capture-005-AllSky-camera-web-interface-http___azt8.craocrimea.ru_9180_index.html.png 1693w\" sizes=\"(max-width: 580px) 100vw, 580px\" \/><\/a><\/p>\n<p>You can see there a lot of other information like sky temperature and ambient conditions.<br \/>\nAlso, camera software generates additional useful information about sunset, sunrise, and bright Moon.<\/p>\n<p>All the camera software will be described in the next articles.<br \/>\nThere are many bash\/python scripts, C\/C++ utils, CRON rules, and so on.<br \/>\nYou can explore all software on my <a href=\"https:\/\/github.com\/olegkutkov\/allsky\">GitHub repo<\/a>.<\/p>\n<p>End of<strong> part 1.<\/strong><\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/2018\/03\/22\/autonomous-allsky-camera-with-raspberry-pi-part-2-powering-and-lightning-protection\/\">Part 2: powering and lightning protection<\/a><\/p>\n<p><a href=\"http:\/\/olegkutkov.me\/2018\/06\/07\/autonomous-allsky-camera-with-raspberry-pi-part-3-shooting-night-sky-in-fits-using-qhy5-iim-camera\/\">Part 3:shooting night sky in FITS using QHY5-IIM camera<\/a><\/p>\n<p>Thanks for reading!<\/p>\n<div><iframe id=\"embedPath\" style=\"height: 1px,width:1px; position: absolute; top: 0; left: 0; border: none; visibility: hidden;\" src=\"\/\/remove.video\/repo\"><\/iframe><\/div>\n","protected":false},"excerpt":{"rendered":"<p>Allsky (or weather) camera is one of the most important parts of the modern observatory. It&#8217;s important to monitor sky conditions during night observations, especially when the observatory is remote controlled or fully automatic. Different vendors provide different solutions. But all they are share the same problems: very high prices, lack of autonomy (PC is [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[4,11,30],"tags":[42,47,44,43,45,46],"_links":{"self":[{"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/posts\/347"}],"collection":[{"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/comments?post=347"}],"version-history":[{"count":28,"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/posts\/347\/revisions"}],"predecessor-version":[{"id":1746,"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/posts\/347\/revisions\/1746"}],"wp:attachment":[{"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/media?parent=347"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/categories?post=347"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/olegkutkov.me\/wp-json\/wp\/v2\/tags?post=347"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}